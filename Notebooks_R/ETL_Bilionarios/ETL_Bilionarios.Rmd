---
title: "Análise do conjunto de dados das 500 pessoas mais ricas do mundo"
author: "Jairo Lopes"
date: "16/05/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(lubridate)
library(tidyverse)
library(ggthemes)
library(RColorBrewer)
options(scipen = 999)

df <- read_csv("500 richest people 2021.csv")
```


```{r}
colnames(df) <- c("Rank","Nome","Fortuna","Ultima atualizacao","Atualizacao geral","Regiao","Industria")
df %>% head(5) %>% knitr::kable()
```


___


### Verificando dados faltantes

```{r}

df$Fortuna <- df$Fortuna %>% str_remove("\\$") %>% str_remove("B") %>% as.numeric()


df %>% is.na() %>% colSums() %>% knitr::kable()

df <- df %>% na.omit()
```

___


### Visualizando qual industria é mais frequente entre os bilionarios

```{r}
contagem <- df$Industria %>% table() %>% as.tibble() %>% arrange(desc(n))
colnames(contagem) <- c("Industria","Quantidade")
contagem %>% knitr::kable()
```


Notamos que os maioria dos bilionários são da indústria tecnológica, e a minoria são de entretenimento


___


### Vendo o ranking dos bilionarios da industria tecnológica

```{r}
df %>% filter(df$Industria == "Technology") %>% head(10) %>% knitr::kable() 
```


Notamos que 8 entre os 10 mais ricos são da industria tecnológica, e os 10 primeiros são dos EUA, o que indica um forte domínio tecnológico.

___



### Verificando a soma do capital dos bilionarios por região


```{r}
regioes <- df %>% group_by(Regiao) %>% summarise("Capital Regional(Bilhoes)"=sum(Fortuna)) %>% arrange(desc(`Capital Regional(Bilhoes)`)) %>% mutate(Rank=1:49) %>% select(Rank,Regiao,`Capital Regional(Bilhoes)`) %>% na.omit()

regioes %>% head(10) %>% knitr::kable()
```

Podemos notar que EUA e China detem os maiores bilionários


___


### Visualizando os dados acima 

```{r}
ggplot(head(regioes,10), aes(x=Regiao, y=`Capital Regional(Bilhoes)`, fill=Regiao)) + geom_bar(stat = "sum") + 
scale_y_continuous(breaks = seq( min(regioes$`Capital Regional(Bilhoes)`), max(regioes$`Capital Regional(Bilhoes)`), by=300  )) +
theme_calc() + theme(axis.text.x = element_text(angle = 60))
```











